<?php

namespace App\Models\OutputTemplates;
use App\Models\CalculationsModel;

class BBRBOnly extends OutputTemplate
{

    protected $formulas = [
        21 => '=IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISBLANK(AM99),ISBLANK(AQ99)),"",IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),"Cellular",""),IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISBLANK(AQ99),ISNUMBER(AM99)),"Satellite",IF(AND(ISBLANK(AE99),ISBLANK(AM99),ISBLANK(AQ99),ISNUMBER(AI99)),"Microwave",IF(AND(ISBLANK(AI99),ISBLANK(AM99),ISBLANK(AQ99),ISNUMBER(AE99)),"Fiber Optic",IF(AND(ISNUMBER(AE99),ISBLANK(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,"Cellular","Fiber Optic"),"Fiber Optic"),IF(AND(ISNUMBER(AE99),ISBLANK(AI99),ISNUMBER(AM99),ISBLANK(AQ99)),IF(AE99<AM99,"Satellite","Fiber Optic"),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISBLANK(AM99),ISBLANK(AQ99)),IF(AE99<AI99,"Microwave","Fiber Optic"),IF(AND(ISBLANK(AE99),ISNUMBER(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,"Cellular","Microwave"),"Microwave"),IF(AND(ISBLANK(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISBLANK(AQ99)),IF(AI99<AM99,"Satellite","Microwave"),IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,"Cellular","Satellite"),"Satellite"),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(AE99<AI99,IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,"Cellular","Microwave"),"Microwave"),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,"Cellular","Fiber Optic"),"Fiber Optic")),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISBLANK(AQ99)),IF(AE99<AI99,IF(AI99<AM99,"Satellite","Microwave"),IF(AE99<AM99,"Satellite","Fiber Optic")),IF(AND(ISNUMBER(AE99),ISBLANK(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(AE99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,"Cellular","Fiber Optic"),"Fiber Optic")),IF(AND(ISBLANK(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(AI99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,"Cellular","Microwave"),"Microwave")),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(AE99<AI99,IF(AI99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,"Cellular","Microwave"),"Microwave")),IF(AE99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,"Cellular","Fiber Optic"),"Fiber Optic"))),""))))))))))))))))',
        22 => '=IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),"", IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),"Cellular",""),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(Q99),ISNUMBER(R99)),"Satellite",IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(N99),ISNUMBER(O99)),"Microwave",IF(AND(ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(K99),ISNUMBER(L99)),"Fiber Optic",IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),"Cellular","Fiber Optic"),"Fiber Optic"),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*5)>(Q99+R99*5),"Satellite","Fiber Optic"),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*5)>(N99+O99*5),"Microwave","Fiber Optic"),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),"Cellular","Microwave"),"Microwave"),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((N99+O99*5)>(Q99+R99*5),"Satellite","Microwave"),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),"Cellular","Satellite"),"Satellite"),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*5)>(N99+O99*5),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),"Cellular","Microwave"),"Microwave"),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),"Cellular","Fiber Optic"),"Fiber Optic")),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*5)>(N99+O99*5),IF((N99+O99*5)>(Q99+R99*5),"Satellite","Microwave"),IF((K99+L99*5)>(Q99+R99*5),"Satellite","Fiber Optic")),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),"Cellular","Fiber Optic"),"Fiber Optic")),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((N99+O99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),"Cellular","Microwave"),"Microwave")),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*5)>(N99+O99*5),IF((N99+O99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),"Cellular","Microwave"),"Microwave")),IF((K99+L99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),"Cellular","Satellite"),"Satellite"),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),"Cellular","Fiber Optic"),"Fiber Optic"))),""))))))))))))))))',
        23 => '=IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),"", IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),S99+T99*5),""),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(Q99),ISNUMBER(R99)),CONCATENATE("Satellite",CHAR(10),Q99+R99*5),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(N99),ISNUMBER(O99)),CONCATENATE("Microwave",CHAR(10),N99+O99*5),IF(AND(ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(K99),ISNUMBER(L99)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*5)>(Q99+R99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*5)>(N99+O99*5),CONCATENATE("Microwave",CHAR(10),N99+O99*5),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((N99+O99*5)>(Q99+R99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*5)>(N99+O99*5),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*5)>(N99+O99*5),IF((N99+O99*5)>(Q99+R99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),IF((K99+L99*5)>(Q99+R99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5))),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((N99+O99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),CONCATENATE("Microwave",CHAR(10),N99+O99*5))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*5)>(N99+O99*5),IF((N99+O99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Microwave",CHAR(10),N99+O99*5)),CONCATENATE("Microwave",CHAR(10),N99+O99*5))),IF((K99+L99*5)>(Q99+R99*5),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),CONCATENATE("Satellite",CHAR(10),Q99+R99*5)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*5)>(S99+T99*5),CONCATENATE("Cellular",CHAR(10),S99+T99*5),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*5)))),""))))))))))))))))',
        24 => '=IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),"", IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),S99+T99*10),""),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(Q99),ISNUMBER(R99)),CONCATENATE("Satellite",CHAR(10),Q99+R99*10),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(N99),ISNUMBER(O99)),CONCATENATE("Microwave",CHAR(10),N99+O99*10),IF(AND(ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(K99),ISNUMBER(L99)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*10)>(Q99+R99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*10)>(N99+O99*10),CONCATENATE("Microwave",CHAR(10),N99+O99*10),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((N99+O99*10)>(Q99+R99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*10)>(N99+O99*10),IF(OR(G99="3G",G99="4G"),IF((N99+O99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*10)>(N99+O99*10),IF((N99+O99*10)>(Q99+R99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),IF((K99+L99*10)>(Q99+R99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*10)>(Q99+R99*10),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10))),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((N99+O99*10)>(Q99+R99*10),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),CONCATENATE("Microwave",CHAR(10),N99+O99*10))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*10)>(N99+O99*10),IF((N99+O99*10)>(Q99+R99*10),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Microwave",CHAR(10),N99+O99*10)),CONCATENATE("Microwave",CHAR(10),N99+O99*10))),IF((K99+L99*10)>(Q99+R99*10),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),CONCATENATE("Satellite",CHAR(10),Q99+R99*10)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*10)>(S99+T99*10),CONCATENATE("Cellular",CHAR(10),S99+T99*10),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*10)))),""))))))))))))))))',
        25 => '=IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),"", IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),S99+T99*15),""),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(Q99),ISNUMBER(R99)),CONCATENATE("Satellite",CHAR(10),Q99+R99*15),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(N99),ISNUMBER(O99)),CONCATENATE("Microwave",CHAR(10),N99+O99*15),IF(AND(ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(K99),ISNUMBER(L99)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*15)>(Q99+R99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*15)>(N99+O99*15),CONCATENATE("Microwave",CHAR(10),N99+O99*15),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((N99+O99*15)>(Q99+R99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*15)>(N99+O99*15),IF(OR(G99="3G",G99="4G"),IF((N99+O99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*15)>(N99+O99*15),IF((N99+O99*15)>(Q99+R99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),IF((K99+L99*15)>(Q99+R99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*15)>(Q99+R99*15),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15))),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((N99+O99*15)>(Q99+R99*15),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),CONCATENATE("Microwave",CHAR(10),N99+O99*15))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*15)>(N99+O99*15),IF((N99+O99*15)>(Q99+R99*15),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Microwave",CHAR(10),N99+O99*15)),CONCATENATE("Microwave",CHAR(10),N99+O99*15))),IF((K99+L99*15)>(Q99+R99*15),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),CONCATENATE("Satellite",CHAR(10),Q99+R99*15)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*15)>(S99+T99*15),CONCATENATE("Cellular",CHAR(10),S99+T99*15),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*15)))),""))))))))))))))))',
        26 => '=IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),"", IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),S99+T99*20),""),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(Q99),ISNUMBER(R99)),CONCATENATE("Satellite",CHAR(10),Q99+R99*20),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(N99),ISNUMBER(O99)),CONCATENATE("Microwave",CHAR(10),N99+O99*20),IF(AND(ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99),ISNUMBER(K99),ISNUMBER(L99)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*20)>(Q99+R99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*20)>(N99+O99*20),CONCATENATE("Microwave",CHAR(10),N99+O99*20),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((N99+O99*20)>(Q99+R99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),IF(AND(ISBLANK(K99),ISBLANK(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISBLANK(Q99),ISBLANK(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*20)>(N99+O99*20),IF(OR(G99="3G",G99="4G"),IF((N99+O99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISBLANK(S99),ISBLANK(T99)),IF((K99+L99*20)>(N99+O99*20),IF((N99+O99*20)>(Q99+R99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),IF((K99+L99*20)>(Q99+R99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISBLANK(N99),ISBLANK(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*20)>(Q99+R99*20),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20))),IF(AND(ISBLANK(K99),ISBLANK(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((N99+O99*20)>(Q99+R99*20),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),CONCATENATE("Microwave",CHAR(10),N99+O99*20))),IF(AND(ISNUMBER(K99),ISNUMBER(L99),ISNUMBER(N99),ISNUMBER(O99),ISNUMBER(Q99),ISNUMBER(R99),ISNUMBER(S99),ISNUMBER(T99)),IF((K99+L99*20)>(N99+O99*20),IF((N99+O99*20)>(Q99+R99*20),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),IF(OR(G99="3G",G99="4G"),IF((N99+O99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Microwave",CHAR(10),N99+O99*20)),CONCATENATE("Microwave",CHAR(10),N99+O99*20))),IF((K99+L99*20)>(Q99+R99*20),IF(OR(G99="3G",G99="4G"),IF((Q99+R99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),CONCATENATE("Satellite",CHAR(10),Q99+R99*20)),IF(OR(G99="3G",G99="4G"),IF((K99+L99*20)>(S99+T99*20),CONCATENATE("Cellular",CHAR(10),S99+T99*20),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)),CONCATENATE("Fiber Optic",CHAR(10),K99+L99*20)))),""))))))))))))))))',
        27 => '=IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISBLANK(AM99),ISBLANK(AQ99)),"", IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),AQ99),""),IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISBLANK(AQ99),ISNUMBER(AM99)),CONCATENATE("Satellite",CHAR(10),AM99),IF(AND(ISBLANK(AE99),ISBLANK(AM99),ISBLANK(AQ99),ISNUMBER(AI99)),CONCATENATE("Microwave",CHAR(10),AI99),IF(AND(ISBLANK(AI99),ISBLANK(AM99),ISBLANK(AQ99),ISNUMBER(AE99)),CONCATENATE("Fiber Optic",CHAR(10),AE99),IF(AND(ISNUMBER(AE99),ISBLANK(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Fiber Optic",CHAR(10),AE99)),CONCATENATE("Fiber Optic",CHAR(10),AE99)),IF(AND(ISNUMBER(AE99),ISBLANK(AI99),ISNUMBER(AM99),ISBLANK(AQ99)),IF(AE99<AM99,CONCATENATE("Satellite",CHAR(10),AM99),CONCATENATE("Fiber Optic",CHAR(10),AE99)),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISBLANK(AM99),ISBLANK(AQ99)),IF(AE99<AI99,CONCATENATE("Microwave",CHAR(10),AI99),CONCATENATE("Fiber Optic",CHAR(10),AE99)),IF(AND(ISBLANK(AE99),ISNUMBER(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Microwave",CHAR(10),AI99)),CONCATENATE("Microwave",CHAR(10),AI99)),IF(AND(ISBLANK(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISBLANK(AQ99)),IF(AI99<AM99,CONCATENATE("Satellite",CHAR(10),AM99),CONCATENATE("Microwave",CHAR(10),AI99)),IF(AND(ISBLANK(AE99),ISBLANK(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Satellite",CHAR(10),AM99)),CONCATENATE("Satellite",CHAR(10),AM99)),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISBLANK(AM99),ISNUMBER(AQ99)),IF(AE99<AI99,IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Microwave",CHAR(10),AI99)),CONCATENATE("Microwave",CHAR(10),AI99)),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Fiber Optic",CHAR(10),AE99)),CONCATENATE("Fiber Optic",CHAR(10),AE99))),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISBLANK(AQ99)),IF(AE99<AI99,IF(AI99<AM99,CONCATENATE("Satellite",CHAR(10),AM99),CONCATENATE("Microwave",CHAR(10),AI99)),IF(AE99<AM99,CONCATENATE("Satellite",CHAR(10),AM99),CONCATENATE("Fiber Optic",CHAR(10),AE99))),IF(AND(ISNUMBER(AE99),ISBLANK(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(AE99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Satellite",CHAR(10),AM99)),CONCATENATE("Satellite",CHAR(10),AM99)),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Fiber Optic",CHAR(10),AE99)),CONCATENATE("Fiber Optic",CHAR(10),AE99))),IF(AND(ISBLANK(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(AI99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Satellite",CHAR(10),AM99)),CONCATENATE("Satellite",CHAR(10),AM99)),IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Microwave",CHAR(10),AI99)),CONCATENATE("Microwave",CHAR(10),AI99))),IF(AND(ISNUMBER(AE99),ISNUMBER(AI99),ISNUMBER(AM99),ISNUMBER(AQ99)),IF(AE99<AI99,IF(AI99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Satellite",CHAR(10),AM99)),CONCATENATE("Satellite",CHAR(10),AM99)),IF(OR(G99="3G",G99="4G"),IF(AI99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Microwave",CHAR(10),AI99)),CONCATENATE("Microwave",CHAR(10),AI99))),IF(AE99<AM99,IF(OR(G99="3G",G99="4G"),IF(AM99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Satellite",CHAR(10),AM99)),CONCATENATE("Satellite",CHAR(10),AM99)),IF(OR(G99="3G",G99="4G"),IF(AE99<AQ99,CONCATENATE("Cellular",CHAR(10),AQ99),CONCATENATE("Fiber Optic",CHAR(10),AE99)),CONCATENATE("Fiber Optic",CHAR(10),AE99)))),""))))))))))))))))',
        28 => '=IF(AND(ISBLANK(AF99),ISBLANK(AJ99),ISBLANK(AN99),ISBLANK(AR99)),"", IF(AND(ISBLANK(AF99),ISBLANK(AJ99),ISBLANK(AN99),ISNUMBER(AR99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),AR99),""),IF(AND(ISBLANK(AF99),ISBLANK(AJ99),ISBLANK(AR99),ISNUMBER(AN99)),CONCATENATE("Satellite",CHAR(10),AN99),IF(AND(ISBLANK(AF99),ISBLANK(AN99),ISBLANK(AR99),ISNUMBER(AJ99)),CONCATENATE("Microwave",CHAR(10),AJ99),IF(AND(ISBLANK(AJ99),ISBLANK(AN99),ISBLANK(AR99),ISNUMBER(AF99)),CONCATENATE("Fiber Optic",CHAR(10),AF99),IF(AND(ISNUMBER(AF99),ISBLANK(AJ99),ISBLANK(AN99),ISNUMBER(AR99)),IF(OR(G99="3G",G99="4G"),IF(AF99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Fiber Optic",CHAR(10),AF99)),CONCATENATE("Fiber Optic",CHAR(10),AF99)),IF(AND(ISNUMBER(AF99),ISBLANK(AJ99),ISNUMBER(AN99),ISBLANK(AR99)),IF(AF99<AN99,CONCATENATE("Satellite",CHAR(10),AN99),CONCATENATE("Fiber Optic",CHAR(10),AF99)),IF(AND(ISNUMBER(AF99),ISNUMBER(AJ99),ISBLANK(AN99),ISBLANK(AR99)),IF(AF99<AJ99,CONCATENATE("Microwave",CHAR(10),AJ99),CONCATENATE("Fiber Optic",CHAR(10),AF99)),IF(AND(ISBLANK(AF99),ISNUMBER(AJ99),ISBLANK(AN99),ISNUMBER(AR99)),IF(OR(G99="3G",G99="4G"),IF(AJ99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Microwave",CHAR(10),AJ99)),CONCATENATE("Microwave",CHAR(10),AJ99)),IF(AND(ISBLANK(AF99),ISNUMBER(AJ99),ISNUMBER(AN99),ISBLANK(AR99)),IF(AJ99<AN99,CONCATENATE("Satellite",CHAR(10),AN99),CONCATENATE("Microwave",CHAR(10),AJ99)),IF(AND(ISBLANK(AF99),ISBLANK(AJ99),ISNUMBER(AN99),ISNUMBER(AR99)),IF(OR(G99="3G",G99="4G"),IF(AN99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Satellite",CHAR(10),AN99)),CONCATENATE("Satellite",CHAR(10),AN99)),IF(AND(ISNUMBER(AF99),ISNUMBER(AJ99),ISBLANK(AN99),ISNUMBER(AR99)),IF(AF99<AJ99,IF(OR(G99="3G",G99="4G"),IF(AJ99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Microwave",CHAR(10),AJ99)),CONCATENATE("Microwave",CHAR(10),AJ99)),IF(OR(G99="3G",G99="4G"),IF(AF99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Fiber Optic",CHAR(10),AF99)),CONCATENATE("Fiber Optic",CHAR(10),AF99))),IF(AND(ISNUMBER(AF99),ISNUMBER(AJ99),ISNUMBER(AN99),ISBLANK(AR99)),IF(AF99<AJ99,IF(AJ99<AN99,CONCATENATE("Satellite",CHAR(10),AN99),CONCATENATE("Microwave",CHAR(10),AJ99)),IF(AF99<AN99,CONCATENATE("Satellite",CHAR(10),AN99),CONCATENATE("Fiber Optic",CHAR(10),AF99))),IF(AND(ISNUMBER(AF99),ISBLANK(AJ99),ISNUMBER(AN99),ISNUMBER(AR99)),IF(AF99<AN99,IF(OR(G99="3G",G99="4G"),IF(AN99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Satellite",CHAR(10),AN99)),CONCATENATE("Satellite",CHAR(10),AN99)),IF(OR(G99="3G",G99="4G"),IF(AF99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Fiber Optic",CHAR(10),AF99)),CONCATENATE("Fiber Optic",CHAR(10),AF99))),IF(AND(ISBLANK(AF99),ISNUMBER(AJ99),ISNUMBER(AN99),ISNUMBER(AR99)),IF(AJ99<AN99,IF(OR(G99="3G",G99="4G"),IF(AN99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Satellite",CHAR(10),AN99)),CONCATENATE("Satellite",CHAR(10),AN99)),IF(OR(G99="3G",G99="4G"),IF(AJ99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Microwave",CHAR(10),AJ99)),CONCATENATE("Microwave",CHAR(10),AJ99))),IF(AND(ISNUMBER(AF99),ISNUMBER(AJ99),ISNUMBER(AN99),ISNUMBER(AR99)),IF(AF99<AJ99,IF(AJ99<AN99,IF(OR(G99="3G",G99="4G"),IF(AN99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Satellite",CHAR(10),AN99)),CONCATENATE("Satellite",CHAR(10),AN99)),IF(OR(G99="3G",G99="4G"),IF(AJ99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Microwave",CHAR(10),AJ99)),CONCATENATE("Microwave",CHAR(10),AJ99))),IF(AF99<AN99,IF(OR(G99="3G",G99="4G"),IF(AN99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Satellite",CHAR(10),AN99)),CONCATENATE("Satellite",CHAR(10),AN99)),IF(OR(G99="3G",G99="4G"),IF(AF99<AR99,CONCATENATE("Cellular",CHAR(10),AR99),CONCATENATE("Fiber Optic",CHAR(10),AF99)),CONCATENATE("Fiber Optic",CHAR(10),AF99)))),""))))))))))))))))',
        29 => '=IF(AND(ISBLANK(AG99),ISBLANK(AK99),ISBLANK(AO99),ISBLANK(AS99)),"", IF(AND(ISBLANK(AG99),ISBLANK(AK99),ISBLANK(AO99),ISNUMBER(AS99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),AS99),""),IF(AND(ISBLANK(AG99),ISBLANK(AK99),ISBLANK(AS99),ISNUMBER(AO99)),CONCATENATE("Satellite",CHAR(10),AO99),IF(AND(ISBLANK(AG99),ISBLANK(AO99),ISBLANK(AS99),ISNUMBER(AK99)),CONCATENATE("Microwave",CHAR(10),AK99),IF(AND(ISBLANK(AK99),ISBLANK(AO99),ISBLANK(AS99),ISNUMBER(AG99)),CONCATENATE("Fiber Optic",CHAR(10),AG99),IF(AND(ISNUMBER(AG99),ISBLANK(AK99),ISBLANK(AO99),ISNUMBER(AS99)),IF(OR(G99="3G",G99="4G"),IF(AG99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Fiber Optic",CHAR(10),AG99)),CONCATENATE("Fiber Optic",CHAR(10),AG99)),IF(AND(ISNUMBER(AG99),ISBLANK(AK99),ISNUMBER(AO99),ISBLANK(AS99)),IF(AG99<AO99,CONCATENATE("Satellite",CHAR(10),AO99),CONCATENATE("Fiber Optic",CHAR(10),AG99)),IF(AND(ISNUMBER(AG99),ISNUMBER(AK99),ISBLANK(AO99),ISBLANK(AS99)),IF(AG99<AK99,CONCATENATE("Microwave",CHAR(10),AK99),CONCATENATE("Fiber Optic",CHAR(10),AG99)),IF(AND(ISBLANK(AG99),ISNUMBER(AK99),ISBLANK(AO99),ISNUMBER(AS99)),IF(OR(G99="3G",G99="4G"),IF(AK99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Microwave",CHAR(10),AK99)),CONCATENATE("Microwave",CHAR(10),AK99)),IF(AND(ISBLANK(AG99),ISNUMBER(AK99),ISNUMBER(AO99),ISBLANK(AS99)),IF(AK99<AO99,CONCATENATE("Satellite",CHAR(10),AO99),CONCATENATE("Microwave",CHAR(10),AK99)),IF(AND(ISBLANK(AG99),ISBLANK(AK99),ISNUMBER(AO99),ISNUMBER(AS99)),IF(OR(G99="3G",G99="4G"),IF(AO99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Satellite",CHAR(10),AO99)),CONCATENATE("Satellite",CHAR(10),AO99)),IF(AND(ISNUMBER(AG99),ISNUMBER(AK99),ISBLANK(AO99),ISNUMBER(AS99)),IF(AG99<AK99,IF(OR(G99="3G",G99="4G"),IF(AK99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Microwave",CHAR(10),AK99)),CONCATENATE("Microwave",CHAR(10),AK99)),IF(OR(G99="3G",G99="4G"),IF(AG99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Fiber Optic",CHAR(10),AG99)),CONCATENATE("Fiber Optic",CHAR(10),AG99))),IF(AND(ISNUMBER(AG99),ISNUMBER(AK99),ISNUMBER(AO99),ISBLANK(AS99)),IF(AG99<AK99,IF(AK99<AO99,CONCATENATE("Satellite",CHAR(10),AO99),CONCATENATE("Microwave",CHAR(10),AK99)),IF(AG99<AO99,CONCATENATE("Satellite",CHAR(10),AO99),CONCATENATE("Fiber Optic",CHAR(10),AG99))),IF(AND(ISNUMBER(AG99),ISBLANK(AK99),ISNUMBER(AO99),ISNUMBER(AS99)),IF(AG99<AO99,IF(OR(G99="3G",G99="4G"),IF(AO99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Satellite",CHAR(10),AO99)),CONCATENATE("Satellite",CHAR(10),AO99)),IF(OR(G99="3G",G99="4G"),IF(AG99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Fiber Optic",CHAR(10),AG99)),CONCATENATE("Fiber Optic",CHAR(10),AG99))),IF(AND(ISBLANK(AG99),ISNUMBER(AK99),ISNUMBER(AO99),ISNUMBER(AS99)),IF(AK99<AO99,IF(OR(G99="3G",G99="4G"),IF(AO99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Satellite",CHAR(10),AO99)),CONCATENATE("Satellite",CHAR(10),AO99)),IF(OR(G99="3G",G99="4G"),IF(AK99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Microwave",CHAR(10),AK99)),CONCATENATE("Microwave",CHAR(10),AK99))),IF(AND(ISNUMBER(AG99),ISNUMBER(AK99),ISNUMBER(AO99),ISNUMBER(AS99)),IF(AG99<AK99,IF(AK99<AO99,IF(OR(G99="3G",G99="4G"),IF(AO99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Satellite",CHAR(10),AO99)),CONCATENATE("Satellite",CHAR(10),AO99)),IF(OR(G99="3G",G99="4G"),IF(AK99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Microwave",CHAR(10),AK99)),CONCATENATE("Microwave",CHAR(10),AK99))),IF(AG99<AO99,IF(OR(G99="3G",G99="4G"),IF(AO99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Satellite",CHAR(10),AO99)),CONCATENATE("Satellite",CHAR(10),AO99)),IF(OR(G99="3G",G99="4G"),IF(AG99<AS99,CONCATENATE("Cellular",CHAR(10),AS99),CONCATENATE("Fiber Optic",CHAR(10),AG99)),CONCATENATE("Fiber Optic",CHAR(10),AG99)))),""))))))))))))))))',
        30 => '=IF(AND(ISBLANK(AH99),ISBLANK(AL99),ISBLANK(AP99),ISBLANK(AT99)),"", IF(AND(ISBLANK(AH99),ISBLANK(AL99),ISBLANK(AP99),ISNUMBER(AT99)),IF(OR(G99="3G",G99="4G"),CONCATENATE("Cellular",CHAR(10),AT99),""),IF(AND(ISBLANK(AH99),ISBLANK(AL99),ISBLANK(AT99),ISNUMBER(AP99)),CONCATENATE("Satellite",CHAR(10),AP99),IF(AND(ISBLANK(AH99),ISBLANK(AP99),ISBLANK(AT99),ISNUMBER(AL99)),CONCATENATE("Microwave",CHAR(10),AL99),IF(AND(ISBLANK(AL99),ISBLANK(AP99),ISBLANK(AT99),ISNUMBER(AH99)),CONCATENATE("Fiber Optic",CHAR(10),AH99),IF(AND(ISNUMBER(AH99),ISBLANK(AL99),ISBLANK(AP99),ISNUMBER(AT99)),IF(OR(G99="3G",G99="4G"),IF(AH99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Fiber Optic",CHAR(10),AH99)),CONCATENATE("Fiber Optic",CHAR(10),AH99)),IF(AND(ISNUMBER(AH99),ISBLANK(AL99),ISNUMBER(AP99),ISBLANK(AT99)),IF(AH99<AP99,CONCATENATE("Satellite",CHAR(10),AP99),CONCATENATE("Fiber Optic",CHAR(10),AH99)),IF(AND(ISNUMBER(AH99),ISNUMBER(AL99),ISBLANK(AP99),ISBLANK(AT99)),IF(AH99<AL99,CONCATENATE("Microwave",CHAR(10),AL99),CONCATENATE("Fiber Optic",CHAR(10),AH99)),IF(AND(ISBLANK(AH99),ISNUMBER(AL99),ISBLANK(AP99),ISNUMBER(AT99)),IF(OR(G99="3G",G99="4G"),IF(AL99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Microwave",CHAR(10),AL99)),CONCATENATE("Microwave",CHAR(10),AL99)),IF(AND(ISBLANK(AH99),ISNUMBER(AL99),ISNUMBER(AP99),ISBLANK(AT99)),IF(AL99<AP99,CONCATENATE("Satellite",CHAR(10),AP99),CONCATENATE("Microwave",CHAR(10),AL99)),IF(AND(ISBLANK(AH99),ISBLANK(AL99),ISNUMBER(AP99),ISNUMBER(AT99)),IF(OR(G99="3G",G99="4G"),IF(AP99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Satellite",CHAR(10),AP99)),CONCATENATE("Satellite",CHAR(10),AP99)),IF(AND(ISNUMBER(AH99),ISNUMBER(AL99),ISBLANK(AP99),ISNUMBER(AT99)),IF(AH99<AL99,IF(OR(G99="3G",G99="4G"),IF(AL99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Microwave",CHAR(10),AL99)),CONCATENATE("Microwave",CHAR(10),AL99)),IF(OR(G99="3G",G99="4G"),IF(AH99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Fiber Optic",CHAR(10),AH99)),CONCATENATE("Fiber Optic",CHAR(10),AH99))),IF(AND(ISNUMBER(AH99),ISNUMBER(AL99),ISNUMBER(AP99),ISBLANK(AT99)),IF(AH99<AL99,IF(AL99<AP99,CONCATENATE("Satellite",CHAR(10),AP99),CONCATENATE("Microwave",CHAR(10),AL99)),IF(AH99<AP99,CONCATENATE("Satellite",CHAR(10),AP99),CONCATENATE("Fiber Optic",CHAR(10),AH99))),IF(AND(ISNUMBER(AH99),ISBLANK(AL99),ISNUMBER(AP99),ISNUMBER(AT99)),IF(AH99<AP99,IF(OR(G99="3G",G99="4G"),IF(AP99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Satellite",CHAR(10),AP99)),CONCATENATE("Satellite",CHAR(10),AP99)),IF(OR(G99="3G",G99="4G"),IF(AH99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Fiber Optic",CHAR(10),AH99)),CONCATENATE("Fiber Optic",CHAR(10),AH99))),IF(AND(ISBLANK(AH99),ISNUMBER(AL99),ISNUMBER(AP99),ISNUMBER(AT99)),IF(AL99<AP99,IF(OR(G99="3G",G99="4G"),IF(AP99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Satellite",CHAR(10),AP99)),CONCATENATE("Satellite",CHAR(10),AP99)),IF(OR(G99="3G",G99="4G"),IF(AL99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Microwave",CHAR(10),AL99)),CONCATENATE("Microwave",CHAR(10),AL99))),IF(AND(ISNUMBER(AH99),ISNUMBER(AL99),ISNUMBER(AP99),ISNUMBER(AT99)),IF(AH99<AL99,IF(AL99<AP99,IF(OR(G99="3G",G99="4G"),IF(AP99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Satellite",CHAR(10),AP99)),CONCATENATE("Satellite",CHAR(10),AP99)),IF(OR(G99="3G",G99="4G"),IF(AL99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Microwave",CHAR(10),AL99)),CONCATENATE("Microwave",CHAR(10),AL99))),IF(AH99<AP99,IF(OR(G99="3G",G99="4G"),IF(AP99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Satellite",CHAR(10),AP99)),CONCATENATE("Satellite",CHAR(10),AP99)),IF(OR(G99="3G",G99="4G"),IF(AH99<AT99,CONCATENATE("Cellular",CHAR(10),AT99),CONCATENATE("Fiber Optic",CHAR(10),AH99)),CONCATENATE("Fiber Optic",CHAR(10),AH99)))),""))))))))))))))))'
    ];


	public function process_simple($objects, $calculation_parameters, $results) {
		//Call the main process to fill base cells
		$this->process($objects, $calculation_parameters, $results);
	}

    public function process_smart($objects, $calculation_parameters, $results) {
        //Call the main process to fill base cells
        $this->process($objects, $calculation_parameters, $results, true);
    }


    public function process($objects, $calculation_parameters, $results, $fillformulas = false)
	{
		parent::process($objects, $calculation_parameters, $results);
		$sheet = $this->spreadsheet->getSheet(0);
		$results_objects = $results['objects'];
		$row_index = 10;//Start row
		$object_index = 0;


		foreach ($objects as $object) {
			$col_index = 1;
			$object_results = json_decode($results_objects[$object_index]['data']);
			$main_results = $object_results->main;
			foreach ((array)$object as $col) {
				//Колонки 1 (A) - 10 (J) просто сохраняем в память и "как есть" (один к одному) перегоняем в теже колонки в выходном темплейте BBRBOnly.xlsx
				if ($col_index >= 1 && $col_index <= 10) {
					$sheet->setCellValueByColumnAndRow($col_index, $row_index, $col);
				}
				//Override with calculated DTF
				if ($col_index === 9 && empty($col) && !empty($object_results->calculated_dtf)) {
					$sheet->setCellValueByColumnAndRow($col_index, $row_index, $object_results->calculated_dtf);
				}
				$col_index++;
			}
			$sheet->setCellValueByColumnAndRow(11, $row_index,
				in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[0] : '');
			$sheet->setCellValueByColumnAndRow(12, $row_index,
				in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[1] : '');

			$sheet->setCellValueByColumnAndRow(14, $row_index,
				in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[2] : '');
			$sheet->setCellValueByColumnAndRow(15, $row_index,
				in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[3] : '');

			//Income
            $sheet->setCellValueByColumnAndRow(13, $row_index,
                in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[24] : '');

            $sheet->setCellValueByColumnAndRow(16, $row_index,
                in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[25] : '');


			$sheet->setCellValueByColumnAndRow(17, $row_index,
				in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[4] : '');
			$sheet->setCellValueByColumnAndRow(18, $row_index,
				in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[5] : '');
			$sheet->setCellValueByColumnAndRow(19, $row_index,
				in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[6] : '');
			$sheet->setCellValueByColumnAndRow(20, $row_index,
				in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[7] : '');


			//Based on maximum  NPV (5-years)


            //Based on minimal cost of ownership  (5-years)
            $sheet->setCellValueByColumnAndRow(22, $row_index,
                '');

			    /*
			     *  $main_results[8] -> FOCL NPV 5
			     *  $main_results[9] -> RTS NPV 5
			     *  $main_results[10] -> Satellite NPV 5
			     *  $main_results[11] -> Cellular NPV 5
			     *  $main_results[12] -> FOCL NPV 10
			     *  $main_results[13] -> FOCL NPV 15
			     *  $main_results[14] -> FOCL NPV 20
			     *  $main_results[15] -> RTS NPV 10
			     *  $main_results[16] -> RTS NPV 15
			     *  $main_results[17] -> RTS NPV 20
			     *  $main_results[18] -> Satellite NPV 10
			     *  $main_results[19] -> Satellite NPV 15
			     *  $main_results[20] -> Satellite NPV 20
			     *  $main_results[21] -> Cellular NPV 10
			     *  $main_results[22] -> Cellular NPV 15
			     *  $main_results[23] -> Cellular NPV 20
			     * */

			/* 31<- FOCL NPV 5
			   32<- FOCL NPV 10
			   33<- FOCL NPV 15
			   34<- FOCL NPV 20
			   35<- RTS NPV 5
			   36<- RTS NPV 10
			   37<- RTS NPV 15
			   38<- RTS NPV 20
			   39<- Satellite NPV 5
			   40<- Satellite NPV 10
			   41<- Satellite NPV 15
			   42<- Satellite NPV 20
			   43<- Cellular NPV 5
			   44<- Cellular NPV 10
			   45<- Cellular NPV 15
			   46<- Cellular NPV 20
			*/

            $sheet->setCellValueByColumnAndRow(31, $row_index,
                in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[8] : '');
            $sheet->setCellValueByColumnAndRow(32, $row_index,
                in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[12] : '');
            $sheet->setCellValueByColumnAndRow(33, $row_index,
                in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[13] : '');
            $sheet->setCellValueByColumnAndRow(34, $row_index,
                in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[14] : '');

            $sheet->setCellValueByColumnAndRow(35, $row_index,
                in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[9] : '');
            $sheet->setCellValueByColumnAndRow(36, $row_index,
                in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[15] : '');
            $sheet->setCellValueByColumnAndRow(37, $row_index,
                in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[16] : '');
            $sheet->setCellValueByColumnAndRow(38, $row_index,
                in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[17] : '');

            $sheet->setCellValueByColumnAndRow(39, $row_index,
                in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[10] : '');
            $sheet->setCellValueByColumnAndRow(40, $row_index,
                in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[18] : '');
            $sheet->setCellValueByColumnAndRow(41, $row_index,
                in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[19] : '');
            $sheet->setCellValueByColumnAndRow(42, $row_index,
                in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[20] : '');

            $sheet->setCellValueByColumnAndRow(43, $row_index,
                in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[11] : '');
            $sheet->setCellValueByColumnAndRow(44, $row_index,
                in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[21] : '');
            $sheet->setCellValueByColumnAndRow(45, $row_index,
                in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[22] : '');
            $sheet->setCellValueByColumnAndRow(46, $row_index,
                in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[23] : '');

            if ($fillformulas)
            {
                $this->fillFormulas($sheet, $row_index);
            }
            else
            {
                    $focl_capex = in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[0] : 0;
                    $focl_opex = in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[1] : 0;

                    $mw_capex = in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[2] : 0;
                    $mw_opex = in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[3] : 0;

                    $sat_capex = in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[4] : 0;
                    $sat_opex = in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[5] : 0;

                    $cel_capex = in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[6] : 0;
                    $cel_opex = in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[7] : 0;

                    $fb_npv_5 = in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[8] : 0;
                    $fb_npv_10 = in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[12] : 0;
                    $fb_npv_15 = in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[13] : 0;
                    $fb_npv_20 = in_array('focl',$calculation_parameters->net_in_output_techs) ? $main_results[14] : 0;

                    $mw_npv_5 = in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[9] : 0;
                    $mw_npv_10 = in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[15] : 0;
                    $mw_npv_15 = in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[16] : 0;
                    $mw_npv_20 = in_array('rts',$calculation_parameters->net_in_output_techs) ? $main_results[17] : 0;

                    $sat_npv_5 = in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[10] : 0;
                    $sat_npv_10 = in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[18] :0;
                    $sat_npv_15 = in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[19] :0;
                    $sat_npv_20 = in_array('satellite',$calculation_parameters->net_in_output_techs) ? $main_results[20] :0;

                    $cel_npv_5 = in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[11] : 0;
                    $cel_npv_10 = in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[21] : 0;
                    $cel_npv_15 = in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[22] : 0;
                    $cel_npv_20 = in_array('cellular',$calculation_parameters->net_in_output_techs) ? $main_results[23] : 0;

                    $is_celullar_coverage = false;

                    if (($object->{7} === "3G") || ($object->{7} === "4G"))
                          $is_celullar_coverage = true;

                    $bFoclParticipated = (bool)(($focl_capex > 0) && ($focl_opex > 0));
                    $bMWParticipated = (bool)(($mw_capex > 0) && ($mw_opex > 0));
                    $bSatParticipated = (bool)(($sat_capex > 0) && ($sat_opex > 0));
                    $bCelParticipated = (bool)((($cel_capex > 0) && ($cel_opex > 0)) && $is_celullar_coverage);

                    $case = 0;

                    //Case 1 - FOCL - false; MW - false; Sat - false; Cell - false - impossible - die?
                    //Case 2 - FOCL - false; MW - false; Sat - false; Cell - true
                    if (!$bFoclParticipated && !$bMWParticipated && !$bSatParticipated && $bCelParticipated) {
                        $case = 1;
                    }

                    //Case 3 - FOCL - false; MW - false; Sat - true; Cell - false
                    if (!$bFoclParticipated && !$bMWParticipated && $bSatParticipated && !$bCelParticipated) {
                        $case = 2;
                    }

                    //Case 4 - FOCL - false; MW - false; Sat - true; Cell - true
                    if (!$bFoclParticipated && !$bMWParticipated && $bSatParticipated && $bCelParticipated) {
                        $case = 3;
                    }

                    //Case 5 - FOCL - false; MW - true; Sat - false; Cell - false
                    if (!$bFoclParticipated && $bMWParticipated && !$bSatParticipated && !$bCelParticipated) {
                        $case = 4;
                    }

                    //Case 6 - FOCL - false; MW - true; Sat - false; Cell - true
                    if (!$bFoclParticipated && $bMWParticipated && !$bSatParticipated && $bCelParticipated) {
                        $case = 5;
                    }

                    //Case 7 - FOCL - false; MW - true; Sat - true; Cell - false
                    if (!$bFoclParticipated && $bMWParticipated && $bSatParticipated && !$bCelParticipated) {
                        $case = 6;
                    }

                    //Case 8 - FOCL - false; MW - true; Sat - true; Cell - true
                    if (!$bFoclParticipated && $bMWParticipated && $bSatParticipated && $bCelParticipated) {
                        $case = 7;
                    }

                    //Case 9 - FOCL - true; MW - false; Sat - false; Cell - false
                    if ($bFoclParticipated && !$bMWParticipated && !$bSatParticipated && !$bCelParticipated) {
                        $case = 8;
                    }

                    //Case 10 - FOCL - true; MW - false; Sat - false; Cell - true
                    if ($bFoclParticipated && !$bMWParticipated && !$bSatParticipated && $bCelParticipated) {
                        $case = 9;
                    }

                    //Case 11 - FOCL - true; MW - false; Sat - true; Cell - false
                    if ($bFoclParticipated && !$bMWParticipated && $bSatParticipated && !$bCelParticipated) {
                        $case = 10;
                    }

                    //Case 12 - FOCL - true; MW - false; Sat - true; Cell - true
                    if ($bFoclParticipated && !$bMWParticipated && $bSatParticipated && $bCelParticipated) {
                        $case = 11;
                    }

                    //Case 13 - FOCL - true; MW - true; Sat - false; Cell - false
                    if ($bFoclParticipated && $bMWParticipated && !$bSatParticipated && !$bCelParticipated) {
                        $case = 12;
                    }

                    //Case 14 - FOCL - true; MW - true; Sat - false; Cell - true
                    if ($bFoclParticipated && $bMWParticipated && !$bSatParticipated && $bCelParticipated) {
                        $case = 13;
                    }

                    //Case 15 - FOCL - true; MW - true; Sat - true; Cell - false
                    if ($bFoclParticipated && $bMWParticipated && $bSatParticipated && !$bCelParticipated) {
                        $case = 14;
                    }

                    //Case 16 - FOCL - true; MW - true; Sat - true; Cell - true
                    if ($bFoclParticipated && $bMWParticipated && $bSatParticipated && $bCelParticipated) {
                        $case = 15;
                    }

                    if ($case > 0) {
                        //Winner by Cost of ownership 5 years
                        $focl_costown5 = $focl_capex + 5 * $focl_opex;
                        $mw_costown5 = $mw_capex + 5 * $mw_opex;
                        $sat_costown5 = $sat_capex + 5 * $sat_opex;
                        $cel_costown5 = $cel_capex + 5 * $cel_opex;

                        $winner5 = CalculationsModel::who_is_the_winner_by_costofownership($case, $focl_costown5, $mw_costown5, $sat_costown5, $cel_costown5);

                        //22 - Based on minimal cost of ownership  (5-years) - text only
                        //23 - Minimal 5-years cost of ownership, USD - text & value

                        $textonly = $winner5;
                        $text_val = '';

                        switch ($winner5) {
                            case 'Fiber':
                                $text_val = $winner5 . "\n" . $focl_costown5;
                                break;
                            case 'Microwave':
                                $text_val = $winner5 . "\n" . $mw_costown5;
                                break;
                            case 'Satellite':
                                $text_val = $winner5 . "\n" . $sat_costown5;
                                break;
                            case 'Cellular':
                                $text_val = $winner5 . "\n" . $cel_costown5;
                                break;
                            default:
                                break;
                        }

                        $sheet->setCellValueByColumnAndRow(22, $row_index, $textonly);
                        $sheet->setCellValueByColumnAndRow(23, $row_index, $text_val);


                        //Winner by Cost of ownership 10 years
                        $focl_costown10 = $focl_capex + 10 * $focl_opex;
                        $mw_costown10 = $mw_capex + 10 * $mw_opex;
                        $sat_costown10 = $sat_capex + 10 * $sat_opex;
                        $cel_costown10 = $cel_capex + 10 * $cel_opex;

                        $winner10 = CalculationsModel::who_is_the_winner_by_costofownership($case, $focl_costown10, $mw_costown10, $sat_costown10, $cel_costown10);


                        //24 - Minimal 10-years cost of ownership, USD - text & value

                        switch ($winner10) {
                            case 'Fiber':
                                $text_val = $winner10 . "\n" . $focl_costown10;
                                break;
                            case 'Microwave':
                                $text_val = $winner10 . "\n" . $mw_costown10;
                                break;
                            case 'Satellite':
                                $text_val = $winner10 . "\n" . $sat_costown10;
                                break;
                            case 'Cellular':
                                $text_val = $winner10 . "\n" . $cel_costown10;
                                break;
                            default:
                                break;
                        }

                        $sheet->setCellValueByColumnAndRow(24, $row_index, $text_val);

                        //Winner by Cost of ownership 15 years
                        $focl_costown15 = $focl_capex + 15 * $focl_opex;
                        $mw_costown15 = $mw_capex + 15 * $mw_opex;
                        $sat_costown15 = $sat_capex + 15 * $sat_opex;
                        $cel_costown15 = $cel_capex + 15 * $cel_opex;

                        $winner15 = CalculationsModel::who_is_the_winner_by_costofownership($case, $focl_costown15, $mw_costown15, $sat_costown15, $cel_costown15);

                        //25 - Minimal 15-years cost of ownership, USD - text & value

                        switch ($winner15) {
                            case 'Fiber':
                                $text_val = $winner15 . "\n" . $focl_costown15;
                                break;
                            case 'Microwave':
                                $text_val = $winner15 . "\n" . $mw_costown15;
                                break;
                            case 'Satellite':
                                $text_val = $winner15 . "\n" . $sat_costown15;
                                break;
                            case 'Cellular':
                                $text_val = $winner15 . "\n" . $cel_costown15;
                                break;
                            default:
                                break;
                        }

                        $sheet->setCellValueByColumnAndRow(25, $row_index, $text_val);

                        //Winner by Cost of ownership 20 years
                        $focl_costown20 = $focl_capex + 20 * $focl_opex;
                        $mw_costown20 = $mw_capex + 20 * $mw_opex;
                        $sat_costown20 = $sat_capex + 20 * $sat_opex;
                        $cel_costown20 = $cel_capex + 20 * $cel_opex;

                        $winner20 = CalculationsModel::who_is_the_winner_by_costofownership($case, $focl_costown20, $mw_costown20, $sat_costown20, $cel_costown20);

                        //26 - Minimal 20-years cost of ownership, USD - text & value

                        switch ($winner20) {
                            case 'Fiber':
                                $text_val = $winner20 . "\n" . $focl_costown20;
                                break;
                            case 'Microwave':
                                $text_val = $winner20 . "\n" . $mw_costown20;
                                break;
                            case 'Satellite':
                                $text_val = $winner20 . "\n" . $sat_costown20;
                                break;
                            case 'Cellular':
                                $text_val = $winner20 . "\n" . $cel_costown20;
                                break;
                            default:
                                break;
                        }

                        $sheet->setCellValueByColumnAndRow(26, $row_index, $text_val);

                        //Winner by NPV 5 years
                        $npv_winner5 = CalculationsModel::who_is_the_winner_by_npv($case, $fb_npv_5, $mw_npv_5, $sat_npv_5, $cel_npv_5);

                        //21 - Based on maximum  NPV (5-years) - text only
                        //27 - Maximum 5-years NPV, USD - text & value

                        $textonly = $npv_winner5;

                        switch ($npv_winner5) {
                            case 'Fiber':
                                $text_val = $npv_winner5 . "\n" . $fb_npv_5;
                                break;
                            case 'Microwave':
                                $text_val = $npv_winner5 . "\n" . $mw_npv_5;
                                break;
                            case 'Satellite':
                                $text_val = $npv_winner5 . "\n" . $sat_npv_5;
                                break;
                            case 'Cellular':
                                $text_val = $npv_winner5 . "\n" . $cel_npv_5;
                                break;
                            default:
                                break;
                        }
                        $sheet->setCellValueByColumnAndRow(21, $row_index, $textonly);
                        $sheet->setCellValueByColumnAndRow(27, $row_index, $text_val);

                        //Winner by NPV 10 years
                        $npv_winner10 = CalculationsModel::who_is_the_winner_by_npv($case, $fb_npv_10, $mw_npv_10, $sat_npv_10, $cel_npv_10);

                        //28 - Maximum 10-years NPV, USD - text & value

                        switch ($npv_winner10) {
                            case 'Fiber':
                                $text_val = $npv_winner10 . "\n" . $fb_npv_10;
                                break;
                            case 'Microwave':
                                $text_val = $npv_winner10 . "\n" . $mw_npv_10;
                                break;
                            case 'Satellite':
                                $text_val = $npv_winner10 . "\n" . $sat_npv_10;
                                break;
                            case 'Cellular':
                                $text_val = $npv_winner10 . "\n" . $cel_npv_10;
                                break;
                            default:
                                break;
                        }

                        $sheet->setCellValueByColumnAndRow(28, $row_index, $text_val);

                        //Winner by NPV 15 years
                        $npv_winner15 = CalculationsModel::who_is_the_winner_by_npv($case, $fb_npv_15, $mw_npv_15, $sat_npv_15, $cel_npv_15);

                        //29 - Maximum 15-years NPV, USD - text & value

                        switch ($npv_winner15) {
                            case 'Fiber':
                                $text_val = $npv_winner15 . "\n" . $fb_npv_15;
                                break;
                            case 'Microwave':
                                $text_val = $npv_winner15 . "\n" . $mw_npv_15;
                                break;
                            case 'Satellite':
                                $text_val = $npv_winner15 . "\n" . $sat_npv_15;
                                break;
                            case 'Cellular':
                                $text_val = $npv_winner15 . "\n" . $cel_npv_15;
                                break;
                            default:
                                break;
                        }

                        $sheet->setCellValueByColumnAndRow(29, $row_index, $text_val);

                        //Winner by NPV 20 years
                        $npv_winner20 = CalculationsModel::who_is_the_winner_by_npv($case, $fb_npv_20, $mw_npv_20, $sat_npv_20, $cel_npv_20);
                        //30 - Maximum 20-years NPV, USD - text & value

                        switch ($npv_winner20) {
                            case 'Fiber':
                                $text_val = $npv_winner20 . "\n" . $fb_npv_20;
                                break;
                            case 'Microwave':
                                $text_val = $npv_winner20 . "\n" . $mw_npv_20;
                                break;
                            case 'Satellite':
                                $text_val = $npv_winner20 . "\n" . $sat_npv_20;
                                break;
                            case 'Cellular':
                                $text_val = $npv_winner20 . "\n" . $cel_npv_20;
                                break;
                            default:
                                break;
                        }

                        $sheet->setCellValueByColumnAndRow(30, $row_index, $text_val);
                    }
                }

            $object_index++;
			$row_index++;
		}
	}

}
